namespace=build_food_export

build_food_export.1 = {
	type = province_event
	hidden = yes
	
	trigger = { 
		OR = { 
			has_building = food_export_infrastructure 
			AND = {
				has_variable = food_export_flag
				NOT = { has_building = food_export_infrastructure }
			}
		}
	}
		
	
	immediate = {
		if = {
			limit = {has_building = food_export_infrastructure }
			switch = {
				trigger = trade_goods
				grain           = { set_variable = {name = old_trade_good value = 1 }}
				salt            = { set_variable = {name = old_trade_good value = 2 }}
				iron            = { set_variable = {name = old_trade_good value = 3 }}
				horses          = { set_variable = {name = old_trade_good value = 4 }}
				wine            = { set_variable = {name = old_trade_good value = 5 }}
				wood            = { set_variable = {name = old_trade_good value = 6 }}
				amber           = { set_variable = {name = old_trade_good value = 7 }}
				stone           = { set_variable = {name = old_trade_good value = 8 }}
				fish            = { set_variable = {name = old_trade_good value = 9 }}
				spices          = { set_variable = {name = old_trade_good value = 10 }}
				elephants       = { set_variable = {name = old_trade_good value = 11 }}
				papyrus         = { set_variable = {name = old_trade_good value = 12 }}
				cloth           = { set_variable = {name = old_trade_good value = 13 }}
				wild_game       = { set_variable = {name = old_trade_good value = 14 }}
				precious_metals = { set_variable = {name = old_trade_good value = 15 }}
				steppe_horses   = { set_variable = {name = old_trade_good value = 16 }}
				cattle          = { set_variable = {name = old_trade_good value = 17 }}
				earthware       = { set_variable = {name = old_trade_good value = 18 }}
				dye             = { set_variable = {name = old_trade_good value = 19 }}
				fur             = { set_variable = {name = old_trade_good value = 20 }}
				olive           = { set_variable = {name = old_trade_good value = 21 }}
				leather         = { set_variable = {name = old_trade_good value = 22 }}
				base_metals     = { set_variable = {name = old_trade_good value = 23 }}
				woad            = { set_variable = {name = old_trade_good value = 24 }}
				marble          = { set_variable = {name = old_trade_good value = 25 }}
				honey           = { set_variable = {name = old_trade_good value = 26 }}
				incense         = { set_variable = {name = old_trade_good value = 27 }}
				hemp            = { set_variable = {name = old_trade_good value = 28 }}
				vegetables      = { set_variable = {name = old_trade_good value = 29 }}
				gems            = { set_variable = {name = old_trade_good value = 30 }}
				camel           = { set_variable = {name = old_trade_good value = 31 }}
				glass           = { set_variable = {name = old_trade_good value = 32 }}
				silk            = { set_variable = {name = old_trade_good value = 33 }}
				dates           = { set_variable = {name = old_trade_good value = 34 }}
			}
			set_trade_goods = food_exports
			set_variable = {name = food_export_flag}
			add_permanent_province_modifier = {name = exporting_food}
			trigger_event = {id = build_food_export.2 }
		}
		else = {
			remove_variable = food_export_flag
			remove_province_modifier = exporting_food
			switch = {
				trigger = var:old_trade_good
				1  = {set_trade_goods = grain}
				2  = {set_trade_goods = salt}
				3  = {set_trade_goods = iron}
				4  = {set_trade_goods = horses}
				5  = {set_trade_goods = wine}
				6  = {set_trade_goods = wood}
				7  = {set_trade_goods = amber}
				8  = {set_trade_goods = stone}
				9  = {set_trade_goods = fish}
				10 = {set_trade_goods = spices}
				11 = {set_trade_goods = elephants}
				12 = {set_trade_goods = papyrus}
				13 = {set_trade_goods = cloth}
				14 = {set_trade_goods = wild_game}
				15 = {set_trade_goods = precious_metals}
				16 = {set_trade_goods = steppe_horses}
				17 = {set_trade_goods = cattle}
				18 = {set_trade_goods = earthware}
				19 = {set_trade_goods = dye}
				20 = {set_trade_goods = fur}
				21 = {set_trade_goods = olive}
				22 = {set_trade_goods = leather}
				23 = {set_trade_goods = base_metals}
				24 = {set_trade_goods = woad}
				25 = {set_trade_goods = marble}
				26 = {set_trade_goods = honey}
				27 = {set_trade_goods = incense}
				28 = {set_trade_goods = hemp}
				29 = {set_trade_goods = vegetables}
				30 = {set_trade_goods = gems}
				31 = {set_trade_goods = camel}
				32 = {set_trade_goods = glass}
				33 = {set_trade_goods = silk}
				34 = {set_trade_goods = dates}
			}
			trigger_event = {id = build_food_export.2 }
		}
	}
}

build_food_export.2 = {
	type = province_event
	hidden = yes
	
	trigger = { 
		has_owner = yes
		OR = {
			AND = {
				state = { trade_good_surplus = { target = food_exports value = 1 }}
				is_state_capital = yes
			}
			has_province_modifier = single_food_export_adjustment
		}
	}
		
	
	immediate = {
		if = {
			limit = {
				AND = {
					state = { trade_good_surplus = { target = food_exports value = 1 }}
					is_state_capital = yes
				}
				NOT = {has_province_modifier = single_food_export_adjustment}
			}
			add_permanent_province_modifier = {name = single_food_export_adjustment}
		}
		
		if = {
			limit = {
				NOT = {
					AND = {
						state = { trade_good_surplus = { target = food_exports value = 1 }}
						is_state_capital = yes
					}
				}
				has_province_modifier = single_food_export_adjustment
			}
			remove_province_modifier = single_food_export_adjustment
		}
	}
}

build_food_export.3 = {
	type = province_event
	hidden = yes
	
	trigger = { 
		OR = {
			trade_goods = grain
			trade_goods = fish
			trade_goods = cattle
			trade_goods = vegetables
		}
	}
		
	
	immediate = {
		random_list = {
			1 = { set_trade_goods = earthware }
			1 = { set_trade_goods = papyrus }
			1 = { set_trade_goods = cloth }
			1 = { set_trade_goods = glass }
			1 = { set_trade_goods = leather }
		}
		add_building_level = food_export_infrastructure
		trigger_event = {id = build_food_export.1 }
	}
}